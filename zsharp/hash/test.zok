import "poseidon"
from "../curves/point" import Point

// public key pk = (pk_x, pk_y). pk_x and pk_y are vesta base field (Fq)
// pk_id.x: 0x009d34e02e1fb42b724cd4967877530530d0f1e11159cf3596dc481f8977b838 // 277759923865700489443680254028997772819898796518026243837764034034985842744
// pk_id.y: 0x18d193e0274b780dd0941dfa79e539491cc2d22133db9e2c64ceecda360c5a5d // 11225800002416332805268224430126171477447903881745461163555431534516484463197

// signature R
// signature.R.x: 0x045ee24c26403b9c5e5a2438b1654db568e684fb813a4eb4fccee0b29de9ec1f // 1976896866080845998547012780228024125994814528371270224048570181907018017823
// signature.R.y: 0x281b2592e8fa08bed5bb85d2695c0fb9882448e4f00b57fd89c02d44e253eef1 // 18140478139382026322017492948051276874528439958558905608720251395070242320113

// commitment to k com_k is pallas scalar field (Fq)
// com_k: 0x26d9e1527a8452ae7158d2fcb5c2c16b0cfa7257f214a611d426af04831a870e // 17572849175767220838780697001699130299539520480762070392848801936435943474958

// start block values (t_start.nonce, t_start.tag, t_start.h) are pallas scalar field (Fq)
// t_start.nonce: 0x0000000000000000000000000000000000000000000000000000000000000000 // 0
// t_start.tag: 0x031e1a38bc77a77b11dc414e5520841cd418b7e1481ca14b1dd7c44c9d3b2e8b // 1410124932703114335545669928171352035882893562004246207865003351544090537611
// t_start.h: 0x1abc39798eff766045af163e060d6476f34f6f9f621e6cec2b4a7268dc8daa9b // 12092697988098012694495368654062153665576291439330597990228546183464433330843

// e during signature is vesta scalar field (Fp)
// e in vesta base (Fq): 0x2e837f148a7c5510a0c660f60c35977963192d8c9405e074cba72a20e40831e7 // 21038725075885441542609551875058782547437465998715360999405656604478861226471
// e in vesta scalar (Fp): 0x2e837f148a7c5510a0c660f60c35977963192d8c9405e074cba72a20e40831e7 // 21038725075885441542609551875058782547437465998715360999405656604478861226471


def main() -> field:
    Point pk = Point {x: 277759923865700489443680254028997772819898796518026243837764034034985842744, y: 11225800002416332805268224430126171477447903881745461163555431534516484463197 }
    Point sign_R = Point {x: 1976896866080845998547012780228024125994814528371270224048570181907018017823, y: 18140478139382026322017492948051276874528439958558905608720251395070242320113 }
    field com_k = 17572849175767220838780697001699130299539520480762070392848801936435943474958
    field t_start_nonce = 0
    field t_start_tag = 1410124932703114335545669928171352035882893562004246207865003351544090537611
    field t_start_h = 12092697988098012694495368654062153665576291439330597990228546183464433330843

    field[8] hash_msg = [0; 8]
    hash_msg[0] = pk.x
    hash_msg[1] = pk.y
    hash_msg[2] = sign_R.x
    hash_msg[3] = sign_R.y
    hash_msg[4] = com_k
    hash_msg[5] = t_start_nonce
    hash_msg[6] = t_start_tag
    hash_msg[7] = t_start_h

    field result = poseidon(hash_msg, false)

    return result